<h1>Bank Reconciliation</h1>

<%= form_for @reconciliation, url: { controller: "reconciliations", action: "reconcile" }, method: :post do |r|%>

  <div class="container">
    <strong>Account Name: </strong><%= @reconciliation.account.name %><br>
    <strong>Statement Date: </strong><%= @reconciliation.statement_date %><br>
    <strong>Statement Balance: </strong><%= number_to_currency(@reconciliation.statement_balance) %>
    <%= r.hidden_field :id %>
    <div id='balance'><%= number_to_currency(@reconciliation.last_reconciled_balance) %></div>

  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4>Transactions
      <button type="submit" class="btn btn-default">Done</button></h4>
    </div>
    
	  <table class="table table-condensed">
      <thead>
        <tr>
          <th>Date</th>
          <th>Memo</th>
          <th>Category</th>
          <th>Subcategory</th>
          <th class="money">Amount</th>
          <th></th>
        </tr>
      </thead>

      <tbody>
        <% @transactions.each do |transaction| %>
          <tr>
            <%= fields_for transaction do |t| %>

              <%= t.hidden_field :id, name: "transactions[][id]" %>
              <td><%= transaction.date %></td>
              <td><%= transaction.memo %></td>
              <td><%= transaction.category.nil? ? "" : transaction.category.name %></td>
              <td><%= transaction.subcategory.nil? ? "": transaction.subcategory.name %></td>
              <td class="money"><%= number_to_currency(transaction.amount) %></td>
              <td><%= t.check_box :add_to_reconciliation, name: "transactions[][add_to_reconciliation]", class: 'reconcile' %></td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div> <!-- end panel-->
<% end %>
